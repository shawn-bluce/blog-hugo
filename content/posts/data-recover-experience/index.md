---
title: "记一次惨痛的数据恢复经验"
slug: "data-recover-experience"
date: "2021-07-21T12:49:00+0000"
lastmod: "2025-01-16T07:39:52+0000"
draft: false
tags:
  - "Data Recover"
visibility: "public"
---
# 0X00 背景

前两段属于并不那么重要的“故事”部分，如果切实需要一些数据恢复的经验和方法的话可以直接跳到`0X02`部分，给个一键三连就好（哦不对这不是B站视频，那你白嫖好了）。

故事大概是这样的，之前我有一台 Synology 的成品 NAS 用来存储我自己的照片、视频、音乐、电脑数据备份和喜欢的电影，不过因为它是单盘位的用了大概三年之后它就几乎满了，我也就开始准备升级 NAS。后来经过一番调研发现自己的需求其实不太适合用 Synology 的成品，因为它性价比低的同时附带的很多软件功能我都不需要，相比于自建 NAS 所需要的计算机知识我也正好具备，就选择自己搭建一台 TrueNAS 出来。准备的配置是`CPU Intel G6400 + RAM 8G X 2 + SSD 120G + SSD 240G + HDD 8T X 3 + HDD 4T`，其中双核四线程的 CPU 给这台 NAS 用已经是完全没有问题了，同时因为使用 ZFS 也就配备了 16G 的内存，8T X 3 作为主要数据存储并且搭配了 240G 的缓存盘；另外那块 4T 是从老群晖上拆下来的，作为独立存储使用；最后最小的 SSD 用来装系统。当时还整理了一篇博客来[记录这件事](<https://blog.just666.com/2021/04/19/nas/>)（最近有一点点小改动）。

本来我那个 4T 的盘拆下来之后就一直没用，直到前几天我突然想把它也塞到我现在的NAS里去，正好把 OMV 换成 TrueNAS，再加一个缓存盘，重构一下自用 NAS 的架构从此就不再管它了。然后我就把重要数据打包一股脑塞到了那个小硬盘里准备重建 NAS（此时我自己的照片、视频、备份文件全部都在这个小硬盘里）。等了几天需要用的 PCI-E 转 m.2 的扩展卡和 PCI-E 转 SATA 的扩展卡都到了之后就开始重新装机。

把扩展卡和 SSD 之类的都装好之后，我特意把小硬盘的线给拔了，防止在重装系统或者其他的时候误伤到它。然后开始一路顺利的安装好了 TrueNAS 并且配置好了 3 X 8T 的存储池之后关机，准备接上小硬盘电源开始往大存储池里恢复数据。

# 0X01 事发

拆开机箱盖、拆开侧面版、给小硬盘插上线、装好侧面版、装好机箱盖、插上电源网线、开机、坐到笔记本前、打开 Firefox 开发者版、打开 TrueNAS 管理页面、输入用户名密码、登陆、找到存储池、格式化刚刚接入的硬盘...... woc，woc，woc 我干了啥！！！

当我意识到我格式化了装满了重要数据的 4T 硬盘之后，本来整个人都很困，结果一秒钟之内就像喝了一百杯 Espresso 一样清醒了。当时脑子里的意识流差不多就是“卧槽完了、卧槽没了、卧槽出大事情了”，愣了几秒钟之后意识到了一个重要的事“刚刚格式化的是机械硬盘”，然后第一时间卸载了挂好的硬盘并且关机断电拆机拔线。

拔掉线之后冷静了一下觉得数据应该还能找回来，赶紧开始想办法。想办法的过程中又想到“我磁盘分区貌似是 xfs 来着，这个估计还难搞”，想到难搞之后整个人又是一愣🤣

然后我开始东找找西找找，看看有没有什么好办法可以恢复数据的。当时第一时间是想到找线下的数据恢复公司，但是找数据恢复公司的话就非常贵了，而且又非常麻烦，就打算想想办法有没有可能自己把数据恢复回来。又想到 `DiskGenius` 可以恢复，但是去官网看了一下这玩意儿好像还有点贵（官网售价 468 元人民币），当然如果肯定可以恢复回来 468 还是值得的，不过我还是想去找找看有没有便宜一点的方案。然后也陆续找了一些其他软件，要么就是没听过的小公司搞的，要么就是特别特别贵的。就在打算去买 `DiskGenius` 的时候发现了一个叫做 **万兴恢复专家** 的软件，当时第一反应是“这种名字一般都不靠谱，就像 21 天精通CPP一样不靠谱”。不过在调查了一下这个软件和公司之后，我发现背后的这家“万兴科技”是上市公司，且旗下有亿图和墨刀两大将，就打算去试试看了。

软件下载下来之后扫描了很长时间，虽然我费尽心思下载到的46G让子弹飞这种都没有扫描到，但是我最最最最重要的照片们几乎都扫描到了，然后我就眼睛都没眨的付费买了永久授权的这个软件，因为才160+块钱对于这么多重要数据来说真的不值一提，然后用了很长一段时间把数据恢复了回来。不过值得说的是，我的几十部电影无一幸存，但是自己拍的照片的幸存率超出 90%（估计的），这个我也没搞明白是为什么。

现在我已经把重要的数据都整理出来了，所以才有心情来整理这篇文章。说是一篇文章，但是前面这段可能对于看官来说都是废话，我也只是想记录一下这么个经历才把它写出来的。最后来总结一下遇到类似情况的时候应该怎么做吧。

# 0X02 总结

首先，首先，首先，数据恢复的最佳时机永远是在数据丢失之前做，换句话说就是 **不要把自己的重要数据搞丢** 。然后如果数据万一真的丢了，那么我总结了几点这次的经验也许对大家有那么一丢丢的帮助

  1. 还是强调不要删掉自己的重要数据，在删除东西之前最好 **冷静** 几秒钟，格式化磁盘之前最好 **冷静** 几分钟
  2. 如果万一删除了或者格式化了，请第一时间先弹出、卸载磁盘，保证 **不要再像磁盘中写入任何数据**
  3. 找到一个你信得过的数据恢复软件，接上存储设备先扫描看看（大多数收费的数据恢复软件扫描也是不要钱的，所以你可以先看看究竟能恢复出来多少数据，可以根据这个数量决定是不是要付费购买软件）
  4. 使用数据恢复软件将数据恢复出来 **不要放在恢复的磁盘里** ，应该单独找个地方存储这些恢复出来的数据

> 什么？你说盗版软件？这种事情就不至于还用盗版软件了吧，别人的软件帮你找回了你最重要的数据，如果是万兴的年费版的话才99块钱，难道你最重要的数据连 99 块钱都不值？

最后需要注意的几个小问题

  1. 如果是误删和“快速格式化”的话，找回来的几率都还比较大
  2. 如果是复写性质的格式化，那基本上也就别想恢复的事儿了
  3. 即使数据恢复回来了，通常情况下文件名也都彻底乱掉了
  4. 如果误删或者格式化之后又写入过文件，写的越多越没戏
  5. 如果你有 100 个文件，恢复率 99% 的话可能会丢一个
  6. 如果 100 个文件压缩保存，恢复率 99% 的话就彻底废了

最后的最后还有嘿嘿，如果你想要彻底毁掉你的硬盘，不想给别人拿着你硬盘恢复数据的机会的话

  1. 格式化的时候不要选择“快速格式化”
  2. 使用专门的工具全盘复写几次
  3. 上一条做不到的话就往磁盘里塞电影，塞满删掉塞满删掉连续个三四次

（毕竟你卖二手电脑，二手相机的时候肯定不会想成为下一个冠希哥吧

好了，我能想到的就只有这些内容了，最后希望大家永远永远永远不会用到这里面数据恢复相关的经验～
